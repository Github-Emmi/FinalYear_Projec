{% extends "admin_templates/base.html" %}
{% load static %}

{% block title %}Timetable List{% endblock %}
{% block dashboard_title %}Manage Timetable{% endblock dashboard_title %}
{% block dashboard_title1 %}Timetable Records{% endblock dashboard_title1 %}

{% block main_content %}
<section class="content">
  <div class="container-fluid">
    {% include 'admin_templates/verification_message.html' with user=user %}

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">All Timetable Entries</h3>
        <a href="{% url 'admin_add_timetable' %}" class="btn btn-primary btn-sm float-right">
          <i class="fas fa-plus"></i> Add Entry
        </a>
      </div>
      <div class="card-body table-responsive p-0">
        <table class="table table-hover text-nowrap">
          <thead class="thead-dark">
            <tr>
              <th>#</th>
              <th>Subject</th>
              <th>Class</th>
              <th>Department</th>
              <th>Day</th>
              <th>Time</th>
              <th>Classroom</th>
              <th>Teacher</th>
              <th>Session</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
  {% for item in timetable %}
  <tr>
    <td>{{ forloop.counter }}</td>
    <td>{{ item.subject.subject_name }} ({{ item.subject.class_id.class_name }})</td>
    <td>{{ item.class_id.class_name }}</td>
    <td>{{ item.department_id.department_name }}</td>
    <td>{{ item.get_day_display }}</td>
    <td>{{ item.start_time|time:"H:i" }} - {{ item.end_time|time:"H:i" }}</td>
    <td>{{ item.classroom|default:"-" }}</td>
    <td>{{ item.teacher.admin.get_full_name|default:"-" }}</td>
    <td>{{ item.session_year.session_name }}</td>
    <td>
      <a href="{% url 'admin_edit_timetable' item.id %}" class="btn btn-sm btn-info">
        <i class="fas fa-edit"></i>
      </a>
      <a href="{% url 'admin_delete_timetable' item.id %}" class="btn btn-sm btn-danger"
         onclick="return confirm('Are you sure you want to delete this entry?');">
        <i class="fas fa-trash"></i>
      </a>
    </td>
  </tr>
  {% empty %}
    <tr><td colspan="10" class="text-center">No timetable entries available.</td></tr>
  {% endfor %}
</tbody>

        </table>
      </div>
    </div>
  </div>
</section>
{% endblock main_content %}
