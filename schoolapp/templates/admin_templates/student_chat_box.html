<div class="card-header">
  <h3 class="card-title">
    {% if selected_student %}
      Conversation with {{ selected_student.admin.get_full_name }}
    {% else %}
      No Student Selected
    {% endif %}
  </h3>
</div>

<div class="card-body" id="chat-box" style="height: 350px; overflow-y: auto;">
  {% for msg in messages %}
    {% if msg.feedback %}
      <!-- Student bubble -->
      <div class="d-flex justify-content-start mb-3">
        <img src="{{ student_list.profile_pic }}" class="chat-avatar mr-2" width="40" height="40">
        <div>
          <div class="chat-time">{{ msg.created_at|date:"M d, g:i a" }}</div>
          <div class="chat-bubble chat-bubble-left">{{ msg.feedback }}</div>
        </div>
      </div>
    {% endif %}

    {% if msg.feedback_reply %}
      <!-- Admin bubble -->
      <div class="d-flex justify-content-end mb-3">
        <div class="text-right">
          <div class="chat-time">{{ msg.updated_at|date:"M d, g:i a" }}</div>
          <div class="d-flex align-items-end">
            <div class="chat-bubble chat-bubble-right mr-2">{{ msg.feedback_reply }}</div>
            <img src="{{ admin_avatar_url }}" class="chat-avatar" width="40" height="40">
          </div>
        </div>
      </div>
    {% endif %}
  {% empty %}
    <p class="text-muted text-center">No messages yet with {{ selected_student.admin.get_full_name }}</p>
  {% endfor %}
</div>

<div class="card-footer">
  <div class="input-group">
    <input type="text" id="reply-message" class="form-control" placeholder="Type your message...">
    <div class="input-group-append">
      <button id="send-reply" class="btn btn-primary" data-student="{{ selected_student.id }}">Send</button>
    </div>
  </div>
</div>
